# Very stripped-down test Makefile

GENERATED  = $(CURDIR)/generated

all: echogen apisrc

echogen:
	echo "echogen: GENERATED = $(GENERATED) CURDIR = $(CURDIR)"
	echo "Shell arguments would be:"
	echo "	" "s#{generated}#$(GENERATED)#"

sedquotes:
	echo 'sedquotes: trying various $(shell) operations: first two'
	echo $(shell grep '^include::' $(APISPEC).txt | sed -e 's/^include:://' -e 's/\[\]/ /')
	echo 'sedquotes: all three'
	echo $(shell grep '^include::' $(APISPEC).txt | sed -e 's/^include:://' -e 's/\[\]/ /' -e "s#{generated}#$(GENERATED)#")

apisrc:
	echo APISPECSRC = $(APISPECSRC)

APISPEC = OpenCL_API
APISPECSRC = $(APISPEC).txt $(GENDEPENDS) \
    $(shell grep '^include::' $(APISPEC).txt | sed -e 's/^include:://' -e 's/\[\]/ /' -e "s#{generated}#$(GENERATED)#" | xargs echo)
